Welcome to OurScheme!

> a defined

> "=============== Problem 3-5 viewable case ================="

> environment cleaned

> x1 defined

> x2 defined

> x3 defined

> TrickySumUp defined

> 55.500

> "Illegal input! the first argument must be smaller or equal to the second."

> 3.500

> 12

> Abs defined

> Real defined

> Int defined

> Power defined

> FindRange defined

> Find-Range defined

> IntFloor defined

> Int-Floor defined

> ( 8192
  16384
)

> 13579

> 13579

> 13579.000

> ( 1024
  1024
)

> 1024

> -13579

> a defined

> "=============== Problem 4 viewable case ================="

> environment cleaned

> cadr defined

> caddr defined

> caar defined

> caadr defined

> caaddr defined

> % defined

> $%%% defined

> KeyPair defined

> RealKey defined

> ListAppend defined

> $ListAppend defined

> ListLength defined

> $ListLength defined

> NthElementOf defined

> $NthElementOf defined

> WithNthElementOfListReplaced defined

> $WithNthElementOfListReplaced defined

> DivisibleBy defined

> PrintListOfStringsAsSentence defined

> PrintListOfSymbolsAsSentence defined

> PrintListOfSymbolsStringsAsSentence defined

> PrintListOfSymbolsNumbersStringsAsSentence defined

> @size@ defined

> @price@ defined

> @quality@ defined

> ResetTransactionState defined

> ProductIndex defined

> TransactionState defined

> Top? defined

> Bottom? defined

> TopPrice? defined

> BottomPrice? defined

> TopSize? defined

> BottomSize? defined

> TopQuality? defined

> BottomQuality? defined

> Downgrade defined

> Upgrade defined

> DowngradeSize defined

> DowngradePrice defined

> DowngradeQuality defined

> UpgradeSize defined

> UpgradePrice defined

> UpgradeQuality defined

> Abs defined

> PriceTag defined

> ExampleExpertise defined

> $expertise-DB defined

> RuleSetOf defined

> $RuleSetOfFrom defined

> WithNthRuleReplaced defined

> Rule defined

> DefineExpertise defined

> $AddToExpertiseDB defined

> $IndexOfExpertiseEntry defined

> ruleList-01 defined

> The expertise 'Expertise-01' has been established.
#t

> rule-139 defined

> The expertise 'Expertise-02' has been established.
#t

> The expertise 'Expertise-03' has been established.
#t

> ListExpertiseNames defined

> $ListExpertiseNames defined

> GetNotYetUsedKeyFromUser defined

> DoDefineCondition defined

> DoDefineAction defined

> GetNotYetUsedExpertiseNameFromUser defined

> NameUsedInExpertiseDB? defined

> $NameUsedInExpertiseDB? defined

> DoDefineExpertiseFromDB defined

> DoReplaceRuleOfExpertiseWithNewlyComposedRuleUsingDB defined

> GetRuleSetFromDB defined

> GetConditionFromDB defined

> GetActionListFromDB defined

> DoSearchCondition defined

> DoSearchAction defined

> DoUpdateCondition defined

> DoUpdateAction defined

> DoRemoveCondition defined

> DoRemoveAction defined

> DoListConditions defined

> DoListActions defined

> DoListConditionKeys defined

> DoListActionKeys defined

> ExpertSystemShell defined

> DoDefineNewExpertise defined

> DoRemoveExpertise defined

> $WithExpertiseRemoved defined

> ListRuleSet defined

> DoReplaceRuleSet defined

> $ReplaceRuleSet defined

> DoReplaceRuleOfRuleSet defined

> $ReplaceRuleOfRuleSet defined

> nil

> ListConditionBST defined

> ListActionBST defined

> ClearConditionDB defined

> ClearActionDB defined

> ListConditionDB defined

> ListActionDB defined

> ListDB-BST defined

> $ListDB-BST defined

> KeyUsedInConditionDB? defined

> KeyUsedInActionDB? defined

> KeyUsedInBST? defined

> $KeyUsedInBST? defined

> ListKeysOfConditionDB defined

> ListKeysOfActionDB defined

> ListKeysOfBST defined

> $ListKeysOfBST defined

> SearchConditionDB defined

> SearchActionDB defined

> SearchBST defined

> $SearchBST defined

> AddToConditionDB defined

> AddToActionDB defined

> AddToBST defined

> $AddToBST defined

> UpdateConditionDB defined

> UpdateActionDB defined

> UpdateBST defined

> $UpdateBST defined

> FindMaxBSTnode defined

> $FindMaxBSTnode defined

> FindMinBSTnode defined

> $FindMinBSTnode defined

> RemoveFromConditionDB defined

> RemoveFromActionDB defined

> RemoveFromBST defined

> $RemoveFromBST defined

> ( DivisibleBy
  n
  7652145
)

> "Key (short-version long-version) : ( 189  568 )"

> "Key (short-version long-version) : ( 94  473 )"

> "Key (short-version long-version) : ( 282  661 )"

> nil

> 20

> 30

> ( ( set!
    a
    ( +
      n
      a
    )
  )
  ( set!
    b
    ( +
      n
      a
      b
    )
  )
)

> "Key (short-version long-version) : ( 189  568 )"

> "Key (short-version long-version) : ( 94  473 )"

> "Key (short-version long-version) : ( 282  661 )"

> nil

> ? > ( 94  473 )
( 189  568 )
( 282  661 )
? > ( 94  473 )
( 189  568 )
( 282  661 )
? > Key of the condition to be searched for > ( DivisibleBy
  n
  7652145
)
? > Key of the action-list to be searched for > ( ( set!
    a
    ( +
      n
      a
    )
  )
  ( set!
    b
    ( +
      n
      a
      b
    )
  )
)
? > ------------------------
( 94  473 )
( DivisibleBy
  n
  7652145
)
------------------------
( 189  568 )
( DivisibleBy
  n
  7652145
)
------------------------
( 282  661 )
( DivisibleBy
  n
  7652145
)
? > ------------------------
( 94  473 )
( ( set!
    a
    ( +
      n
      a
    )
  )
  ( set!
    b
    ( +
      n
      a
      b
    )
  )
)
------------------------
( 189  568 )
( ( set!
    a
    ( +
      n
      a
    )
  )
  ( set!
    b
    ( +
      n
      a
      b
    )
  )
)
------------------------
( 282  661 )
( ( set!
    a
    ( +
      n
      a
    )
  )
  ( set!
    b
    ( +
      n
      a
      b
    )
  )
)
? > Expertise-03
Expertise-02
Expertise-01
ExampleExpertise
? > Please give the name of the expertise > "NoSuchExpertise not found in expertise-DB"
? > Please give the name of the expertise > ( ( ( DivisibleBy
      n
      3
    )
    ( cond
      ( ( not
          ( TopSize?
          )
        )
        ( UpgradeSize
        )
      )
      ( ( not
          ( TopPrice?
          )
        )
        ( UpgradePrice
        )
      )
      ( ( not
          ( TopQuality?
          )
        )
        ( UpgradeQuality
        )
      )
    )
    ( TransactionState
    )
  )
  ( ( DivisibleBy
      n
      5
    )
    ( cond
      ( ( not
          ( BottomSize?
          )
        )
        ( DowngradeSize
        )
      )
      ( ( not
          ( BottomPrice?
          )
        )
        ( DowngradePrice
        )
      )
      ( ( not
          ( BottomQuality?
          )
        )
        ( DowngradeQuality
        )
      )
    )
    ( TransactionState
    )
  )
  ( else
    ( if
      ( not
        ( TopPrice?
        )
      )
      ( UpgradePrice
      )
    )
    ( TransactionState
    )
  )
)
? > Please give the name of the expertise > ( ( ( DivisibleBy
      n
      3
    )
    ( cond
      ( ( not
          ( TopSize?
          )
        )
        ( UpgradeSize
        )
      )
      ( ( not
          ( TopPrice?
          )
        )
        ( UpgradePrice
        )
      )
      ( ( not
          ( TopQuality?
          )
        )
        ( UpgradeQuality
        )
      )
    )
    ( TransactionState
    )
  )
  ( ( DivisibleBy
      n
      5
    )
    ( cond
      ( ( not
          ( BottomSize?
          )
        )
        ( DowngradeSize
        )
      )
      ( ( not
          ( BottomPrice?
          )
        )
        ( DowngradePrice
        )
      )
      ( ( not
          ( BottomQuality?
          )
        )
        ( DowngradeQuality
        )
      )
    )
    ( TransactionState
    )
  )
  ( else
    ( if
      ( not
        ( TopPrice?
        )
      )
      ( UpgradePrice
      )
    )
    ( TransactionState
    )
  )
)
? > Bye!

> "quality : 3 size : 2 price : 3 ProductIndex : 5"

> "quality : 3 size : 3 price : 3 ProductIndex : 6"

> "quality : 3 size : 3 price : 4 ProductIndex : 7"

> ? > Key (at least 5 digits) associated with the to-be-defined-item > The condition to be added to the DB > Key (short-version long-version) : ( 156  3518792 )
? > Key (at least 5 digits) associated with the to-be-defined-item > The condition to be added to the DB > Key (short-version long-version) : ( 128  5478952 )
? > Key (at least 5 digits) associated with the to-be-defined-item > The condition to be added to the DB > Key (short-version long-version) : ( 323  9157342 )
? > Key (at least 5 digits) associated with the to-be-defined-item > The condition to be added to the DB > Key (short-version long-version) : ( 362  1749826 )
? > Key (at least 5 digits) associated with the to-be-defined-item > The condition to be added to the DB > Key (short-version long-version) : ( 373  4865217 )
? > ( 94  473 )
( 128  5478952 )
( 156  3518792 )
( 189  568 )
( 282  661 )
( 323  9157342 )
( 362  1749826 )
( 373  4865217 )
? > Name of the to-be-defined-expertise > Define a new rule from Condition/Action-list in DB? (Y/N) > Key of the condition > Key of the action-list > Define a new rule from Condition/Action-list in DB? (Y/N) > Key of the condition > Key of the action-list > Define a new rule from Condition/Action-list in DB? (Y/N) > Key of the condition > Key of the action-list > Define a new rule from Condition/Action-list in DB? (Y/N) > The expertise 'TryTrySee' has been established.
? > Bye!

> 20

> 30

> 71024

> 35507

> 71024

> 177505

> 70994

> 177505

> 319473

> 106481

> 319473

> ? > TryTrySee
Expertise-03
Expertise-02
Expertise-01
ExampleExpertise
? > Please give the name of the expertise > ( ( ( DivisibleBy
      n
      7652145
    )
    ( set!
      a
      ( +
        n
        a
      )
    )
    ( set!
      b
      ( +
        n
        a
        b
      )
    )
  )
  ( ( DivisibleBy
      n
      7652145
    )
    ( set!
      a
      ( +
        n
        a
      )
    )
    ( set!
      b
      ( +
        n
        a
        b
      )
    )
  )
  ( else
    ( set!
      a
      ( +
        n
        a
      )
    )
    ( set!
      b
      ( +
        n
        a
        b
      )
    )
  )
)
? > Key (at least 5 digits) associated with the to-be-defined-item > The action-list to be added to the DB > Key (short-version long-version) : ( 231  49256587 )
? > Key (at least 5 digits) associated with the to-be-defined-item > The action-list to be added to the DB > Key (short-version long-version) : ( 245  398574 )
? > Key (at least 5 digits) associated with the to-be-defined-item > The action-list to be added to the DB > Key (short-version long-version) : ( 251  1124365 )
? > Key (at least 5 digits) associated with the to-be-defined-item > The action-list to be added to the DB > Key (short-version long-version) : ( 83  9258674 )
? > Key (at least 5 digits) associated with the to-be-defined-item > The action-list to be added to the DB > Key (short-version long-version) : ( 157  4545125 )
? > Key (at least 5 digits) associated with the to-be-defined-item > The action-list to be added to the DB > Key (short-version long-version) : ( 40  8416872 )
? > Key (at least 5 digits) associated with the to-be-defined-item > Sorry, this key is already in use. Please specify another one.
Key (at least 5 digits) associated with the to-be-defined-item > The action-list to be added to the DB > Key (short-version long-version) : ( 59  5545587 )
? > Key (at least 5 digits) associated with the to-be-defined-item > The action-list to be added to the DB > Key (short-version long-version) : ( 106  2653485 )
? > ( 40  8416872 )
( 59  5545587 )
( 83  9258674 )
( 94  473 )
( 106  2653485 )
( 157  4545125 )
( 189  568 )
( 231  49256587 )
( 245  398574 )
( 251  1124365 )
( 282  661 )
? > Name of the to-be-defined-expertise > Define a new rule from Condition/Action-list in DB? (Y/N) > Key of the condition > Key of the action-list > Define a new rule from Condition/Action-list in DB? (Y/N) > Key of the condition > Key of the action-list > Define a new rule from Condition/Action-list in DB? (Y/N) > Key of the condition > Key of the action-list > Define a new rule from Condition/Action-list in DB? (Y/N) > Key of the condition > Key of the action-list > Define a new rule from Condition/Action-list in DB? (Y/N) > The expertise 'OverSpent' has been established.
? > Name of the to-be-defined-expertise > Define a new rule from Condition/Action-list in DB? (Y/N) > Key of the condition > Key of the action-list > Define a new rule from Condition/Action-list in DB? (Y/N) > Key of the condition > Key of the action-list > Define a new rule from Condition/Action-list in DB? (Y/N) > Key of the condition > Key of the action-list > Define a new rule from Condition/Action-list in DB? (Y/N) > Key of the condition > Key of the action-list > Define a new rule from Condition/Action-list in DB? (Y/N) > The expertise 'Exaggerated' has been established.
? > Bye!

> #t

> "quality : 3 size : 4 price : 3 ProductIndex : 7"

> "quality : 3 size : 5 price : 3 ProductIndex : 8"

> "quality : 3 size : 5 price : 4 ProductIndex : 9"

> "quality : 3 size : 5 price : 5 ProductIndex : 10"

> "quality : 4 size : 5 price : 5 ProductIndex : 15"

> "quality : 4 size : 5 price : 5 ProductIndex : 15"

> "quality : 5 size : 5 price : 5 ProductIndex : 21"

> "quality : 5 size : 5 price : 5 ProductIndex : 21"

> "quality : 5 size : 4 price : 5 ProductIndex : 20"

> "quality : 5 size : 3 price : 5 ProductIndex : 19"

> "quality : 5 size : 3 price : 5 ProductIndex : 19"

> "quality : 5 size : 2 price : 5 ProductIndex : 18"

> "quality : 5 size : 1 price : 5 ProductIndex : 17"

> "quality : 5 size : 1 price : 4 ProductIndex : 18"

> "quality : 5 size : 1 price : 3 ProductIndex : 19"

> "quality : 5 size : 1 price : 2 ProductIndex : 20"

> "quality : 5 size : 1 price : 1 ProductIndex : 21"

> "quality : 4 size : 1 price : 1 ProductIndex : 15"

> "quality : 3 size : 1 price : 1 ProductIndex : 2"

> "quality : 3 size : 2 price : 1 ProductIndex : 3"

> "quality : 3 size : 3 price : 1 ProductIndex : 4"

> "quality : 3 size : 4 price : 1 ProductIndex : 5"

> "quality : 3 size : 5 price : 1 ProductIndex : 6"

> "quality : 3 size : 5 price : 2 ProductIndex : 7"

> "quality : 3 size : 5 price : 3 ProductIndex : 8"

> "quality : 3 size : 5 price : 4 ProductIndex : 9"

> "quality : 3 size : 5 price : 5 ProductIndex : 10"

> "quality : 3 size : 5 price : 5 ProductIndex : 10"

> "quality : 4 size : 5 price : 5 ProductIndex : 15"

> ? > Key of the condition to remove > ? > Key of the condition to remove > ? > ( 94  473 )
( 128  5478952 )
( 156  3518792 )
( 282  661 )
( 362  1749826 )
( 373  4865217 )
? > Key of the action-list to remove > ? > Key of the action-list to remove > ? > Key of the action-list to remove > ? > ( 59  5545587 )
( 83  9258674 )
( 94  473 )
( 106  2653485 )
( 157  4545125 )
( 189  568 )
( 245  398574 )
( 282  661 )
? > Key of the condition to be searched for > SearchBST error : the key 323 (originally 9157342) is not on the BST.
? > Key of the condition to be searched for > ( >=
  n
  100000
)
? > Key of the action-list to be searched for > SearchBST error : the key 113 (originally 78945) is not on the BST.
? > Key of the action-list to be searched for > SearchBST error : the key 251 (originally 1124365) is not on the BST.
? > Key of the action-list to be searched for > ( ( let
    ( ( %p
        ( PriceTag
          n
        )
      )
    )
    ( cond
      ( ( and
          ( <=
            500000
            %p
          )
          ( <=
            %p
            800000
          )
        )
        #t
      )
      ( ( <
          %p
          500000
        )
        ( cond
          ( ( not
              ( TopSize?
              )
            )
            ( UpgradeSize
            )
          )
          ( ( not
              ( TopPrice?
              )
            )
            ( UpgradePrice
            )
          )
          ( ( not
              ( TopQuality?
              )
            )
            ( UpgradeQuality
            )
          )
        )
      )
      ( ( <
          800000
          %p
        )
        ( cond
          ( ( not
              ( BottomSize?
              )
            )
            ( DowngradeSize
            )
          )
          ( ( not
              ( BottomPrice?
              )
            )
            ( DowngradePrice
            )
          )
          ( ( not
              ( BottomQuality?
              )
            )
            ( DowngradeQuality
            )
          )
        )
      )
    )
    ( TransactionState
    )
  )
)
? > Bye!

> #t

> "quality : 3 size : 4 price : 3 ProductIndex : 7"

> "quality : 3 size : 5 price : 3 ProductIndex : 8"

> "quality : 3 size : 5 price : 4 ProductIndex : 9"

> "quality : 3 size : 5 price : 5 ProductIndex : 10"

> "quality : 4 size : 5 price : 5 ProductIndex : 15"

> "quality : 4 size : 5 price : 5 ProductIndex : 15"

> "quality : 5 size : 5 price : 5 ProductIndex : 21"

> "quality : 5 size : 5 price : 5 ProductIndex : 21"

> "quality : 5 size : 4 price : 5 ProductIndex : 20"

> "quality : 5 size : 3 price : 5 ProductIndex : 19"

> "quality : 5 size : 3 price : 5 ProductIndex : 19"

> "quality : 5 size : 2 price : 5 ProductIndex : 18"

> "quality : 5 size : 1 price : 5 ProductIndex : 17"

> "quality : 5 size : 1 price : 4 ProductIndex : 18"

> "quality : 5 size : 1 price : 3 ProductIndex : 19"

> "quality : 5 size : 1 price : 2 ProductIndex : 20"

> "quality : 5 size : 1 price : 1 ProductIndex : 21"

> "quality : 4 size : 1 price : 1 ProductIndex : 15"

> "quality : 3 size : 1 price : 1 ProductIndex : 2"

> "quality : 3 size : 2 price : 1 ProductIndex : 3"

> "quality : 3 size : 3 price : 1 ProductIndex : 4"

> "quality : 3 size : 4 price : 1 ProductIndex : 5"

> "quality : 3 size : 5 price : 1 ProductIndex : 6"

> "quality : 3 size : 5 price : 2 ProductIndex : 7"

> "quality : 3 size : 5 price : 3 ProductIndex : 8"

> "quality : 3 size : 5 price : 4 ProductIndex : 9"

> "quality : 3 size : 5 price : 5 ProductIndex : 10"

> "quality : 3 size : 5 price : 5 ProductIndex : 10"

> "quality : 4 size : 5 price : 5 ProductIndex : 15"

> #t

> "quality : 3 size : 4 price : 3 ProductIndex : 7"

> "quality : 3 size : 5 price : 3 ProductIndex : 8"

> "quality : 3 size : 5 price : 4 ProductIndex : 9"

> "quality : 3 size : 5 price : 5 ProductIndex : 10"

> "quality : 3 size : 4 price : 5 ProductIndex : 9"

> "quality : 3 size : 3 price : 5 ProductIndex : 8"

> "quality : 3 size : 2 price : 5 ProductIndex : 7"

> "quality : 3 size : 1 price : 5 ProductIndex : 6"

> "quality : 3 size : 1 price : 4 ProductIndex : 5"

> "quality : 3 size : 1 price : 3 ProductIndex : 4"

> "quality : 3 size : 1 price : 2 ProductIndex : 3"

> "quality : 3 size : 1 price : 2 ProductIndex : 3"

> "quality : 3 size : 1 price : 2 ProductIndex : 3"

> "quality : 3 size : 1 price : 2 ProductIndex : 3"

> ++ defined

> ? > Key (at least 5 digits) associated with the to-be-defined-item > The action-list to be added to the DB > Key (short-version long-version) : ( 164  7457747 )
? > Name of the expertise you want to replace its rule > Ordering of the rule that is to be replaced - Please enter a number (e.g., 3) > We now need to compose a new rule using existing DB entries.
Key of the condition > Key of the action-list > The specified rule of OverSpent has been replaced. 
? > Bye!

> #t

> "quality : 3 size : 4 price : 3 ProductIndex : 7"

> "quality : 3 size : 5 price : 3 ProductIndex : 8"

> "quality : 3 size : 5 price : 4 ProductIndex : 9"

> "quality : 3 size : 5 price : 5 ProductIndex : 10"

> "quality : 4 size : 5 price : 5 ProductIndex : 15"

> "quality : 4 size : 5 price : 5 ProductIndex : 15"

> "quality : 5 size : 5 price : 5 ProductIndex : 21"

> "quality : 5 size : 5 price : 5 ProductIndex : 21"

> "quality : 5 size : 4 price : 5 ProductIndex : 20"

> "quality : 5 size : 3 price : 5 ProductIndex : 19"

> "quality : 5 size : 2 price : 5 ProductIndex : 18"

> "quality : 5 size : 1 price : 5 ProductIndex : 17"

> "quality : 5 size : 1 price : 4 ProductIndex : 18"

> "quality : 5 size : 1 price : 3 ProductIndex : 19"

> "quality : 5 size : 1 price : 2 ProductIndex : 20"

> "quality : 5 size : 1 price : 1 ProductIndex : 21"

> "quality : 4 size : 1 price : 1 ProductIndex : 15"

> "quality : 3 size : 1 price : 1 ProductIndex : 2"

> "quality : 3 size : 2 price : 1 ProductIndex : 3"

> "quality : 3 size : 2 price : 1 ProductIndex : 3"

> "quality : 3 size : 3 price : 1 ProductIndex : 4"

> "quality : 3 size : 4 price : 1 ProductIndex : 5"

> "quality : 3 size : 5 price : 1 ProductIndex : 6"

> "quality : 3 size : 5 price : 2 ProductIndex : 7"

> "quality : 3 size : 5 price : 3 ProductIndex : 8"

> "quality : 3 size : 5 price : 4 ProductIndex : 9"

> "quality : 3 size : 5 price : 5 ProductIndex : 10"

> "quality : 4 size : 5 price : 5 ProductIndex : 15"

> "quality : 4 size : 5 price : 5 ProductIndex : 15"

> "quality : 4 size : 5 price : 4 ProductIndex : 16"

> "quality : 4 size : 5 price : 3 ProductIndex : 17"

> "quality : 4 size : 5 price : 2 ProductIndex : 18"

> "quality : 4 size : 5 price : 1 ProductIndex : 19"

> "quality : 4 size : 4 price : 1 ProductIndex : 18"

> "quality : 4 size : 3 price : 1 ProductIndex : 17"

> "quality : 4 size : 2 price : 1 ProductIndex : 16"

> "quality : 4 size : 1 price : 1 ProductIndex : 15"

> "quality : 3 size : 1 price : 1 ProductIndex : 2"

> "quality : 2 size : 1 price : 1 ProductIndex : -4"

> "quality : 1 size : 1 price : 1 ProductIndex : -8"

> "quality : 1 size : 1 price : 1 ProductIndex : -8"

> #t

> "quality : 3 size : 4 price : 3 ProductIndex : 7"

> "quality : 3 size : 5 price : 3 ProductIndex : 8"

> "quality : 3 size : 5 price : 4 ProductIndex : 9"

> "quality : 3 size : 5 price : 5 ProductIndex : 10"

> "quality : 3 size : 5 price : 4 ProductIndex : 9"

> "quality : 3 size : 5 price : 3 ProductIndex : 8"

> "quality : 3 size : 5 price : 2 ProductIndex : 7"

> "quality : 3 size : 5 price : 1 ProductIndex : 6"

> "quality : 3 size : 4 price : 1 ProductIndex : 5"

> "quality : 3 size : 3 price : 1 ProductIndex : 4"

> "quality : 3 size : 2 price : 1 ProductIndex : 3"

> "quality : 3 size : 1 price : 1 ProductIndex : 2"

> "quality : 2 size : 1 price : 1 ProductIndex : -4"

> 
Thanks for using OurScheme!